<div
  class="container-fluid"
  style="
    background-image: url('/images/backgroundLogin.jpg');
    background-size: cover;
    background-position: center;
    min-height: 100vh;
  "
>
  <div class="row justify-content-center align-items-center min-vh-100">
    <div class="col-md-7">
      <div
        class="shadow container"
        style="background-color: rgba(255, 255, 255, 0.85); margin-block: 35px"
      >
        <div class="text-center mb-3">
          <div class="avatar mx-auto">
            <i class="fa-solid fa-user fa-3x text-white"></i>
          </div>
        </div>

        <h3 class="text-center header" style="color: #633c84">
          إنشاء حساب جديد
        </h3>
        <p class="text-center text-muted mb-1">
          سجل بياناتك للوصول إلى خدماتنا
        </p>

        <!-- Form Code Starts Here -->
        <form
          [formGroup]="registerForm"
          (ngSubmit)="registerSubmit()"
          class="p-2"
        >
          <div class="row">
            <div class="col-md-6">
              <!-- Username -->
              <div class="mb-2">
                <label for="userName" class="form-label"
                  >اسم المستخدم <span class="text-danger">*</span></label
                >
                <input
                  id="userName"
                  type="text"
                  formControlName="userName"
                  class="form-control form-input"
                  [class]="
                    registerForm.get('userName')?.invalid &&
                    registerForm.get('userName')?.touched
                  "
                />
                @if (registerForm.get('userName')?.hasError('required') &&
                registerForm.get('userName')?.touched) {
                <div class="invalid-feedback">اسم المستخدم مطلوب.</div>
                } @else if (registerForm.get('userName')?.hasError('pattern') &&
                registerForm.get('userName')?.touched) {
                <div class="invalid-feedback">
                  يجب أن يتكون اسم المستخدم من أحرف أو أرقام فقط.
                </div>
                } @else if (usernameError) {
                <div class="invalid-feedback">{{ usernameError }}</div>
                }
              </div>

              <!-- First Name -->
              <div class="mb-2">
                <label for="FName" class="form-label"
                  >الاسم الأول <span class="text-danger">*</span></label
                >
                <input
                  id="FName"
                  type="text"
                  formControlName="FName"
                  class="form-control form-input"
                  [class]="
                    registerForm.get('FName')?.invalid &&
                    registerForm.get('FName')?.touched
                  "
                />
                @if (registerForm.get('FName')?.hasError('required') &&
                registerForm.get('FName')?.touched) {
                <div class="invalid-feedback">الاسم الأول مطلوب.</div>
                } @else if (registerForm.get('FName')?.hasError('pattern') &&
                registerForm.get('FName')?.touched) {
                <div class="invalid-feedback">
                  يجب أن يحتوي الاسم الأول على أحرف فقط.
                </div>
                }
              </div>

              <!-- Last Name -->
              <div class="mb-2">
                <label for="LName" class="form-label"
                  >الاسم الأخير <span class="text-danger">*</span></label
                >
                <input
                  id="LName"
                  type="text"
                  formControlName="LName"
                  class="form-control form-input"
                  [class]="
                    registerForm.get('LName')?.invalid &&
                    registerForm.get('LName')?.touched
                  "
                />
                @if (registerForm.get('LName')?.hasError('required') &&
                registerForm.get('LName')?.touched) {
                <div class="invalid-feedback">الاسم الأخير مطلوب.</div>
                } @else if (registerForm.get('LName')?.hasError('pattern') &&
                registerForm.get('LName')?.touched) {
                <div class="invalid-feedback">
                  يجب أن يحتوي الاسم الأخير على أحرف فقط.
                </div>
                }
              </div>

              <!-- Email -->
              <div class="mb-2">
                <label for="email" class="form-label"
                  >البريد الإلكتروني <span class="text-danger">*</span></label
                >
                <input
                  id="email"
                  type="email"
                  formControlName="Email"
                  class="form-control form-input"
                  [class]="
                    registerForm.get('Email')?.invalid &&
                    registerForm.get('Email')?.touched
                  "
                />
                @if (registerForm.get('Email')?.hasError('required') &&
                registerForm.get('Email')?.touched) {
                <div class="invalid-feedback">البريد الإلكتروني مطلوب.</div>
                } @else if (registerForm.get('Email')?.hasError('email') &&
                registerForm.get('Email')?.touched) {
                <div class="invalid-feedback">
                  يرجى إدخال بريد إلكتروني صحيح.
                </div>
                }
              </div>

              <!-- Password -->
              <div class="mb-2">
                <label for="password" class="form-label"
                  >كلمة المرور <span class="text-danger">*</span></label
                >
                <input
                  id="password"
                  type="password"
                  formControlName="Password"
                  class="form-control form-input"
                  [class]="
                    registerForm.get('Password')?.invalid &&
                    registerForm.get('Password')?.touched
                  "
                />
                @if (registerForm.get('Password')?.hasError('required') &&
                registerForm.get('Password')?.touched) {
                <div class="invalid-feedback">كلمة المرور مطلوبة.</div>
                } @else if (registerForm.get('Password')?.hasError('minlength')
                && registerForm.get('Password')?.touched) {
                <div class="invalid-feedback">
                  يجب أن تتكون كلمة المرور من 8 أحرف على الأقل.
                </div>
                } @else if (registerForm.get('Password')?.hasError('pattern') &&
                registerForm.get('Password')?.touched) {
                <div class="invalid-feedback">
                  كلمة المرور يجب أن تحتوي على حرف كبير ورقم ورمز خاص.
                </div>
                }
              </div>
            </div>

            <div class="col-md-6">
              <!-- Phone -->
              <div class="mb-2">
                <label for="Phone" class="form-label"
                  >رقم الهاتف <span class="text-danger">*</span></label
                >
                <input
                  id="Phone"
                  type="text"
                  formControlName="Phone"
                  class="form-control form-input"
                  [class]="
                    registerForm.get('Phone')?.invalid &&
                    registerForm.get('Phone')?.touched
                  "
                />
                @if (registerForm.get('Phone')?.hasError('required') &&
                registerForm.get('Phone')?.touched) {
                <div class="invalid-feedback">رقم الهاتف مطلوب.</div>
                } @else if (registerForm.get('Phone')?.hasError('pattern') &&
                registerForm.get('Phone')?.touched) {
                <div class="invalid-feedback">
                  رقم الهاتف يجب أن يبدأ بـ 010/011/012/015 ويكون 11 رقمًا.
                </div>
                }
              </div>

              <!-- Date of Birth -->
              <div class="mb-2">
                <label for="date" class="form-label"
                  >تاريخ الميلاد <span class="text-danger">*</span></label
                >
                <input
                  id="date"
                  type="date"
                  formControlName="DateOfBirth"
                  class="form-control form-input"
                  [class]="
                    registerForm.get('DateOfBirth')?.invalid &&
                    registerForm.get('DateOfBirth')?.touched
                  "
                />
                @if (registerForm.get('DateOfBirth')?.hasError('required') &&
                registerForm.get('DateOfBirth')?.touched) {
                <div class="invalid-feedback">تاريخ الميلاد مطلوب.</div>
                }
              </div>

              <!-- City -->
              <div class="mb-2">
                <label class="form-label"
                  >المدينة <span class="text-danger">*</span></label
                >
                <select
                  title="city"
                  formControlName="City"
                  class="form-select form-input"
                  [class]="
                    registerForm.get('City')?.invalid &&
                    registerForm.get('City')?.touched
                  "
                >
                  <option value="">اختر المدينة</option>
                  @for (city of Cities; track city) {
                  <option [value]="city">{{ city }}</option>
                  }
                </select>
                @if (registerForm.get('City')?.hasError('required') &&
                registerForm.get('City')?.touched) {
                <div class="invalid-feedback">اختر المدينة.</div>
                }
              </div>

              <!-- Street -->
              <div class="mb-2">
                <label class="form-label"
                  >الشارع <span class="text-danger">*</span></label
                >
                <input
                  type="text"
                  formControlName="Street"
                  class="form-control form-input"
                  placeholder="اسم المنطقة ورقم العمارة (مثال: مدينة نصر 15)"
                  [class]="
                    registerForm.get('Street')?.invalid &&
                    registerForm.get('Street')?.touched
                  "
                />
                @if (registerForm.get('Street')?.hasError('required') &&
                registerForm.get('Street')?.touched) {
                <div class="invalid-feedback">الشارع مطلوب.</div>
                } @else if (registerForm.get('Street')?.hasError('pattern') &&
                registerForm.get('Street')?.touched) {
                <div class="invalid-feedback">
                  يجب أن يحتوي الشارع على أحرف وأرقام فقط.
                </div>
                }
              </div>

              <!-- Gender -->
              <div class="mb-2">
                <label class="form-label"
                  >النوع <span class="text-danger">*</span></label
                >
                <div class="d-flex gap-3">
                  <button
                    type="button"
                    class="btn male-button flex-fill"
                    [class.active]="registerForm.get('gender')?.value === 0"
                    (click)="registerForm.get('gender')?.setValue(0)"
                  >
                    <i
                      class="fa-solid fa-person fa-lg me-1"
                      style="color: #3b82f6"
                    ></i>
                    ذكر
                  </button>
                  <button
                    type="button"
                    class="btn female-button flex-fill"
                    [class.active]="registerForm.get('gender')?.value === 1"
                    (click)="registerForm.get('gender')?.setValue(1)"
                  >
                    <i
                      class="fa-solid fa-person-dress fa-lg me-1"
                      style="color: #633c84"
                    ></i>
                    أنثى
                  </button>
                </div>
                @if (registerForm.get('gender')?.hasError('required') &&
                registerForm.get('gender')?.touched) {
                <div class="invalid-feedback d-block mt-1">النوع مطلوب.</div>
                }
              </div>
            </div>
          </div>

          <!-- Error Message -->
          @if (errorMessage) {
          <div class="error-message">
            <i class="fas fa-exclamation-triangle"></i>
            <span>{{ errorMessage }}</span>
          </div>
          }

          <div class="text-center mt-3">
            <button
              type="submit"
              class="btn gradient-button text-white w-100 py-2"
              [disabled]="registerForm.pending"
            >
              تسجيل
            </button>
          </div>
        </form>

        <p class="text-center mt-4">
          <span style="color: #6b7280">هل لديك حساب بالفعل؟</span>
          <a
            class="text-decoration-none ms-1 fw-bold"
            routerLink="/login"
            style="color: #633c84; transition: all 0.3s ease"
            onmouseover="this.style.textShadow='0 0 8px rgba(147, 51, 234, 0.4)'"
            onmouseout="this.style.textShadow='none'"
          >
            تسجيل الدخول
          </a>
        </p>
      </div>
    </div>
  </div>
</div>
